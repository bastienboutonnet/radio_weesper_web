{{ define "main" }}
<main class="schedule-page homepage">
  <script src="/js/live-marquee.js"></script>
  <!-- Live banner -->
  {{ partial "live-banner.html" . }}

  <section class="recent-section container">
    <!-- <h1 class="page-title">Schedule</h1> -->
    {{ partial "schedule.html" . }}
  </section>

  <section class="recent-section container">
    <h2 class="recent-heading page-title">Latest Shows</h2>
    <div class="recent-posts">
      {{ $now := now }}
      {{ $pastShows := where (where .Site.RegularPages "Section" "post") "Date" "<" $now }}
      {{ range first 6 $pastShows }}
        {{ $p := . }}
        {{ $showtime := .Params.showtime }}
        {{ $title := (or .Params.show_name .Title) }}
        {{ if or (and $showtime (ne $showtime "")) (and $title (ne $title "")) }}
        <article class="recent-post">
          {{ with .Params.image }}
          <img
            class="recent-post-img"
            src="{{ . | relURL }}"
            alt="{{ with $p.Params.show_name }}{{ . }}{{ else }}{{ $p.Title }}{{ end }}"
          />
          {{ end }}
          <div class="recent-post-content">
            <div class="upcoming-meta">
              <span class="upcoming-pill upcoming-pill-date">{{ .Date.Format "Mon, 02 Jan" }}</span>
              {{- $stime := .Params.showtime -}}
              {{ if $stime }}
              <span class="upcoming-pill upcoming-pill-time">{{ $stime }}</span>
              {{ end }}
            </div>
            <h3 class="recent-title">{{ with .Params.show_name }}{{ . }}{{ else }}{{ .Title }}{{ end }}</h3>
            <div class="post-tags">
              {{ with .Params.tags }} {{ range first 4 . }}<span class="post-tag"
                >{{ . }}</span
              >{{ end }} {{ end }}
            </div>
          </div>
          <a class="card-link" href="{{ .RelPermalink }}" aria-label="Open {{ with .Params.show_name }}{{ . }}{{ else }}{{ .Title }}{{ end }}"></a>
        </article>
        {{ end }}
      {{ end }}
    </div>
  </section>
</main>
{{ end }}
