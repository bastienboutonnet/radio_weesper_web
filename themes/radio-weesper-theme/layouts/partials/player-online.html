<section class="player-section">
  <div class="player">
    <p class="media-message">VIDEO PLAYER</p>
  </div>
  {{ with index (first 1 (where .Site.RegularPages "Section" "post")) 0 }}
  <aside class="now-playing">
    <div class="now-playing-info">
      {{ $hasResident := isset .Params "is_resident" }}
      {{ $isResident := cond $hasResident .Params.is_resident true }}
      {{ $artists := .Params.artists }}
      {{ if not $artists }}{{ $artists = slice (or .Params.show_name .Title) }}{{ end }}
      {{ $artistsStr := partial "format-artists.html" (dict "artists" $artists) }}
      {{ $showName := .Params.show_name }}
      {{ $title := (or $showName .Title) }}
      {{ $displayTitle := cond (and (not $isResident) (not $showName)) $artistsStr $title }}
      <h3 class="show-title">{{ $displayTitle }}</h3>
      {{ if $isResident }}
        <p class="now-playing-artists">with {{ $artistsStr }}</p>
      {{ else }}
        <p class="now-playing-artists">Guestmix</p>
      {{ end }}
      {{ if and .Params.showtime .Params.showendtime }}
      <p class="show-time">
        {{ .Params.showtime }} - {{ .Params.showendtime }}
      </p>
      {{ else if .Params.showtime }}
      <p class="show-time">{{ .Params.showtime }}</p>
      {{ else if .Params.showendtime }}
      <p class="show-time">{{ .Params.showendtime }}</p>
      {{ end }} {{ if .Params.description }}
      <p class="show-description">{{ .Params.description }}</p>
      {{ else }}
      <p class="show-description">{{ .Summary }}</p>
      {{ end }}
      <div class="post-tags" style="margin-top: auto">
        {{ with .Params.tags }} {{ range first 4 . }}<span class="post-tag"
          >{{ . }}</span
        >{{ end }} {{ end }}
      </div>
    </div>
  </aside>
  {{ else }}
  <aside class="now-playing">
    <h2 class="now-playing-heading">Now Playing</h2>
    <p class="show-description">
      No show yet. Add a post in <code>content/post/</code>.
    </p>
  </aside>
  {{ end }}
</section>
